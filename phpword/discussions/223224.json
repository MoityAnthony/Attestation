[
  {
    "Id": "479163",
    "ThreadId": "223224",
    "Html": "<p>Hello:<br>I was trying to do the same thing that textrun does, have a paragraph with text in differents formats in a listitem, but i couldn't do it.And reviewing the code i did some changes to do that..</p>\r\n<p><br>first call the method in this way</p>\r\n<p>&nbsp;</p>\r\n<pre><div style=\"color:black;background-color:white\"><pre>$<span style=\"color:blue\">list</span>=$section-&gt;addListItem(utf8_decode(<span style=\"color:#a31515\">'Normal '</span>, 0);</pre>\r\n<pre>$<span style=\"color:blue\">list</span>-&gt;addText(<span style=\"color:#a31515\">'Bold'</span>,<span style=\"color:blue\">array</span>(<span style=\"color:#a31515\">'bold'</span> =&gt; <span style=\"color:#a31515\">'Bold'</span>));\r\n</pre>\r\n</div>\r\n</pre>\r\n<p>&nbsp;</p>\r\n<p>until here no changes are necessary.....<br><br><br>Now in PHPWord -&gt; Section -&gt; ListItem.php, I modified the constructor and added one attribute (elementCollection) and two methods (getElements and addText)</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">private</span> $_elementCollection;</pre>\r\n<pre><span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> addText($text = null, $styleFont = null)&nbsp;</pre>\r\n<pre>{&nbsp;</pre>\r\n<pre>   $givenText = utf8_encode($text);&nbsp;</pre>\r\n<pre>   $text = <span style=\"color:blue\">new</span> PHPWord_Section_Text($givenText, $styleFont);&nbsp;</pre>\r\n<pre>   $this-&gt;_elementCollection[] = $text;&nbsp;</pre>\r\n<pre><span style=\"color:blue\">   return</span> $text;&nbsp;</pre>\r\n<pre>}</pre>\r\n<pre><span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> getElements()&nbsp;</pre>\r\n<pre>{&nbsp;</pre>\r\n<pre><span style=\"color:blue\">   </span><span style=\"color:blue\">return</span> $this-&gt;_elementCollection;&nbsp;</pre>\r\n<pre>}\r\n</pre>\r\n</div>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> __construct($text, $depth = 0, $styleFont = null, $styleList = null, $styleParagraph = null)&nbsp;</pre>\r\n<pre>{&nbsp;</pre>\r\n<pre>   $this-&gt;_style = <span style=\"color:blue\">new</span> PHPWord_Style_ListItem();&nbsp;</pre>\r\n<pre>   $this-&gt;_textObject = <span style=\"color:blue\">new</span> PHPWord_Section_Text($text, $styleFont, $styleParagraph);&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</pre>\r\n<pre>   $this-&gt;_elementCollection[] = $this-&gt;_textObject;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</pre>\r\n<pre>   $this-&gt;_depth = $depth;&nbsp;&nbsp; &nbsp;&nbsp;</pre>\r\n<pre><span style=\"color:blue\">   if</span>(!is_null($styleList) &amp;&amp; is_array($styleList))&nbsp;</pre>\r\n<pre>   {&nbsp;</pre>\r\n<pre><span style=\"color:blue\">      foreach</span>($styleList <span style=\"color:blue\">as</span> $key =&gt; $value)&nbsp;</pre>\r\n<pre>      {&nbsp;</pre>\r\n<pre><span style=\"color:blue\">         if</span>(substr($key, 0, 1) != <span style=\"color:#a31515\">'_'</span>)&nbsp;</pre>\r\n<pre>         {&nbsp;</pre>\r\n<pre>            $key = <span style=\"color:#a31515\">'_'</span>.$key;&nbsp;</pre>\r\n<pre>         }&nbsp;</pre>\r\n<pre>         $this-&gt;_style-&gt;setStyleValue($key, $value);&nbsp;</pre>\r\n<pre>      }&nbsp;</pre>\r\n<pre>   }&nbsp;</pre>\r\n<pre>}\r\n</pre>\r\n</div>\r\n<p><br>and finally in PHPWord -&gt; Writer -&gt; Word2007 -&gt; Document.php I modified the method writeListItem replacing&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$this-&gt;_writeText($objWriter, $textObject, true);\r\n</pre>\r\n</div>\r\n<p><br><br>for this<br><br><br></p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>$elements = $listItem-&gt;getElements();&nbsp;</pre>\r\n<pre><span style=\"color:blue\">if</span>(count($elements) &gt; 0)&nbsp;</pre>\r\n<pre>{&nbsp;</pre>\r\n<pre><span style=\"color:blue\">   foreach</span>($elements <span style=\"color:blue\">as</span> $element)&nbsp;</pre>\r\n<pre>   {&nbsp;</pre>\r\n<pre><span style=\"color:blue\">      if</span>($element <span style=\"color:blue\">instanceof</span> PHPWord_Section_Text)&nbsp;</pre>\r\n<pre>      {&nbsp;</pre>\r\n<pre>         $this-&gt;_writeText($objWriter, $element, true);&nbsp;</pre>\r\n<pre>      }&nbsp;</pre>\r\n<pre><span style=\"color:blue\">      elseif</span>($element <span style=\"color:blue\">instanceof</span> PHPWord_Section_Link)&nbsp;</pre>\r\n<pre>      {&nbsp;</pre>\r\n<pre>         $this-&gt;_writeLink($objWriter, $element, true);&nbsp;</pre>\r\n<pre>      }&nbsp;</pre>\r\n<pre>   }&nbsp;&nbsp; &nbsp;</pre>\r\n<pre>}\r\n\r\n</pre>\r\n</div>\r\n<p><br>and done. Now you can add text with different formats in the same line of the list.<br><br><br>Grettings<br><br><br><br><br></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-08-11T08:16:11.13-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "479176",
    "ThreadId": "223224",
    "Html": "<p>Really awesome!<br><br>I will integrate your code in the next release.</p>",
    "PostedDate": "2010-08-11T08:57:23.36-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]