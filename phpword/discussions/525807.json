[
  {
    "Id": "1196979",
    "ThreadId": "525807",
    "Html": "Hi,\r<br />\n<br />\nI've a mysql database localization table with text fragments in various languages.\r<br />\nThey're already in UTF-8. \r<br />\n<br />\nI'm trying to put these text fragments in a word table.\r<br />\n<br />\nAll languages are displayed fine with PHPWord, except those Right-to-Left (hebrew, arabic, ...) which are displayed left-to-right. There's no garbage; they're just <em>not</em> right-to-left in the docx generated by PHPWord.\r<br />\n<br />\nI've tried either with 0.6.2-1 and with the 0.7.0 from github.\r<br />\n<br />\nAny idea how could I handle RTL languages?\r<br />\n<br />\nIs it possible to put a raw &quot;manually&quot; encoded piece of xml in a textrun or table cell?\r<br />\n<br />\nThank you\r<br />\n<br />\nG.<br />\n",
    "PostedDate": "2014-01-25T01:57:12.967-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1197084",
    "ThreadId": "525807",
    "Html": "Ok, it seems like I kinda did it by myself.\r<br />\n<br />\nMaybe it's primitive and needs further work (for example, stuff like &lt;w:lang w:bidi=”xx-YY”/&gt; where xx-YY is the locale) but it works.\r<br />\n<br />\nThe solution is adding &lt;w:rtl/&gt; XML element before the Right-To-Left text.\r<br />\n<br />\nGo to class PHPWord_Style_Font in file PHPWord/Style/Font.php:<br />\n<pre><code>// add this field after private $_fgColor;\nprivate $_rtl;\n\n// add this line in the constructor &quot;public function __construct&quot;\n// after $this-&gt;_fgColor = null;\n$this-&gt;_rtl = null;\n\n// add these two methods at the end of the class\n\npublic function getRtl() {\n    return $this-&gt;_rtl;\n}\n\npublic function setRtl($pValue = false) {\n    if($pValue == '') {\n        $pValue = false;\n    }\n    $this-&gt;_rtl = $pValue;\n    return $this;\n}    </code></pre>\n\nGo to class PHPWord_Writer_Word2007_Base  in file PHPWord/Writer/Word2007/Base.php:<br />\n<pre><code>// in method protected function _writeTextStyle\n// add after if ($font != 'Arial') { ... } \n\n// RTL\nif(!is_null($rtl)) {\n    // &lt;w:rtl/&gt;\n    $objWriter-&gt;startElement('w:rtl');\n    $objWriter-&gt;endElement();\n}</code></pre>\n\nTo use it:<br />\n<pre><code>$section-&gt;addText('مرحبا العالم', array('rtl' =&gt; true)); // writes &quot;hello world&quot; in arabic according to google translator :-)</code></pre>\n\n",
    "PostedDate": "2014-01-25T03:28:44.623-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]