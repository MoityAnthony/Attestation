[
  {
    "Id": "600890",
    "ThreadId": "254789",
    "Html": "<p>How can i create a dynamic table and insret it in a template</p>\n<p>\n<div style=\"color: black; background-color: white;\">\n<pre>&lt;?php\n<span style=\"color: blue;\">require_once</span> <span style=\"color: #a31515;\">'../PHPWord.php'</span>;\n$competences = <span style=\"color: blue;\">array</span>(\n        <span style=\"color: #a31515;\">\"Developpement\"</span>  =&gt; <span style=\"color: blue;\">array</span>(\n              <span style=\"color: #a31515;\">\"JAVA\"</span>,<span style=\"color: #a31515;\">\"PHP\"</span>,<span style=\"color: #a31515;\">\"HTML\"</span>),\n     \n        <span style=\"color: #a31515;\">\"Data base\"</span>  =&gt; <span style=\"color: blue;\">array</span>(\n              <span style=\"color: #a31515;\">\"ORACLE\"</span>,<span style=\"color: #a31515;\">\"MYSQL\"</span>,<span style=\"color: #a31515;\">\"DATABASE\"</span>),\n     \n        <span style=\"color: #a31515;\">\"Framework\"</span>  =&gt; <span style=\"color: blue;\">array</span>(\n              <span style=\"color: #a31515;\">\"LIEFRY\"</span> ,<span style=\"color: #a31515;\">\"STRUTS\"</span> ,<span style=\"color: #a31515;\">\"NOHETO\"</span> \n\t\t\t  )\n);\n$PHPWord = <span style=\"color: blue;\">new</span> PHPWord();\n\n$document = $PHPWord-&gt;loadTemplate(<span style=\"color: #a31515;\">'CV.docx'</span>);\n\n$document-&gt;setValue(<span style=\"color: #a31515;\">'Nom'</span>, <span style=\"color: #a31515;\">'Boukrim'</span>);\n$document-&gt;setValue(<span style=\"color: #a31515;\">'Prenom'</span>, <span style=\"color: #a31515;\">'Ahmed'</span>);\n\n\n<span style=\"color: green;\">/*****   dynamic table  ******/</span>\n<span style=\"color: green;\">// New portrait section</span>\n\n\t$section = $PHPWord-&gt;createSection();\n\t$table = $section-&gt;addTable();\n\t<span style=\"color: blue;\">foreach</span>($competences <span style=\"color: blue;\">as</span> $cle1 =&gt; $valeur1)\n\t\t{\n\t\t\t<span style=\"color: blue;\">foreach</span> ($valeur1 <span style=\"color: blue;\">as</span> $cle2=&gt;$valeur2)\n\t\t\t\t \n\t\t\t{\n\t\t\t $table-&gt;addRow();\n\t\t\t $table-&gt;addCell(1750)-&gt;addText(<span style=\"color: #a31515;\">\"$cle1,$valeur2\"</span>);\n\t\t\t}\n\t\t}\n\n\n<span style=\"color: green;\">/******   end dynamic table  ****/</span>\n$document-&gt;setValue(<span style=\"color: #a31515;\">'Competences'</span>,$table );\n\n$document-&gt;save(<span style=\"color: #a31515;\">'Novediacv.docx'</span>);\n?&gt;\n</pre>\n</div>\n</p>",
    "PostedDate": "2011-04-21T03:36:05.43-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "700511",
    "ThreadId": "254789",
    "Html": "<p>Let me just start out with, I needed this functionality YESTERDAY, however as such, its not possible using this method. &nbsp;</p>\n<p>What I have found WORKS, will require a bit of know-how about how tables are laid out in XML (Don't worry, I explain enough of it here, if you have a passing knowledge of HTML markup, you'll be able to follow!).</p>\n<p><em><strong><span style=\"color: #ff0000;\">WARNING: &nbsp;I don't claim that the following code is 100% perfect word XML, but is the bare minimum of fussing that I've found still works fine in word (2010, at least).</span></strong></em></p>\n<p>Instead of using the built-in table setup (I realize this loses some formatting functionality, but peruse some xml sheets out of a live word document and you can figure out where to add in the formatting), I built my tables as a string of XML markup.</p>\n<p>Essentially:</p>\n<div style=\"color: black; background-color: white;\">\n<pre>HTML:\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">table</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">table</span><span style=\"color: blue;\">&gt;</span>\nis replaced by XML:\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tbl</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tbl</span><span style=\"color: blue;\">&gt;</span>\n\nHTML:\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">tr</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">tr</span><span style=\"color: blue;\">&gt;</span>\nis replaced by XML:\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tr</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tr</span><span style=\"color: blue;\">&gt;</span>\n\nHTML:\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">td</span><span style=\"color: blue;\">&gt;</span>CONTENT HERE<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">td</span><span style=\"color: blue;\">&gt;</span>\nis replaced by XML:\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tc</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">p</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">r</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">t</span><span style=\"color: blue;\">&gt;</span>CONTENT HERE<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">t</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">p</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tc</span><span style=\"color: blue;\">&gt;</span>\n\nSo if you generate your table something like this:\n\n$table = \"<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tbl</span><span style=\"color: blue;\">&gt;</span>\";\nforeach($competences as $cle1 =&gt; $valeur1){\n  foreach($valeur1 as $cle2=&gt;$valeur2){\n    $table .= \"<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tr</span><span style=\"color: blue;\">&gt;</span>\";\n    $table .= \"<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tc</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">p</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">r</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">t</span><span style=\"color: blue;\">&gt;</span>\";\n    $table .= \"$cle1,$valeur2\";\n    $table .= \"<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">t</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">p</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tc</span><span style=\"color: blue;\">&gt;</span>\";\n    $table .= \"<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tr</span><span style=\"color: blue;\">&gt;</span>\";\n  }\n}\n$table .= '<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tbl</span><span style=\"color: blue;\">&gt;</span>';\n\n$document-&gt;setValue('Competences',$table);</pre>\n</div>\n<p>I've found this works like a charm, however AS IS offers no formatting options. &nbsp;If you want formatting options, tear apart a simple word document and look for the XML that does what you want it to do.</p>\n<p>\n<div style=\"color: black; background-color: white;\">\n<pre>Hint:\nAt least for me, adding:\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tblPr</span><span style=\"color: blue;\">&gt;</span>\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tblW</span> <span style=\"color: red;\">w:w</span> <span style=\"color: blue;\">=</span> <span style=\"color: black;\">\"</span><span style=\"color: blue;\">5000</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">w:type</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">pct</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\n<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tblPr</span><span style=\"color: blue;\">&gt;</span>\nAFTER the <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">tbl</span><span style=\"color: blue;\">&gt;</span>\ngave me a 100% wide table with cells that auto-adjust their width.\n</pre>\n</div>\n</p>",
    "PostedDate": "2011-11-18T21:11:40.9-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "767734",
    "ThreadId": "254789",
    "Html": "<p>Hi xomby, great post! I'm having to build a word document with table data from a database.</p>\r\n<p>Questions: what do you put in the template to replace as a table? In other words, where is ${Competences} in the xml markup? Is it just a line of text by itself where you want the table?</p>\r\n<p>I'm using PHPWord to build my 'template' and plan to use the template functions to replace all the variable data. I'm assuming the docx file can be saved with a new name. Otherwise, I'll have to copy the template first each time a user needs to create a document. It's a customer quote in word format by the way.</p>\r\n<p>Creating the pdf version using FOP was much simpler!</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks!</p>",
    "PostedDate": "2012-02-15T08:01:42.013-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "768091",
    "ThreadId": "254789",
    "Html": "<blockquote style=\"border: solid .1em #ccc; font-style: italic; margin: .25em 1em 0 1em; padding: 0 .25em 0 .25em;\"><strong>frrogoy wrote:</strong><br />\n<p>...Questions: what do you put in the template to replace as a table? In other words, where is ${Competences} in the xml markup? Is it just a line of text by itself where you want the table?...</p>\n</blockquote>\n<p>${COMPETENCES} would go in the template file, wherever you want the table to show up. &nbsp;Essentially what the above \"hack\" code does is write the XML that gets inserted where ${COMPETENCES} goes...</p>\n<p>Here's the important parts of the actual function I use in my application:</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: green;\">//takes in single DB letter data</span>\n<span style=\"color: blue;\">function</span> evalLetter($data,$filename){\n\t$PHPWord = <span style=\"color: blue;\">new</span> PHPWord();\n\t$template = $PHPWord-&gt;loadTemplate(<span style=\"color: #a31515;\">'templates/'</span>.$data[<span style=\"color: #a31515;\">'code'</span>].<span style=\"color: #a31515;\">'.tpl.docx'</span>);\n\t$template-&gt;setValue(<span style=\"color: #a31515;\">'ACCOUNTNUMBER'</span>,$data[<span style=\"color: #a31515;\">'accountnumber'</span>]);\n\t$select = '\n\tSELECT * FROM data_debts,data_clients WHERE data_debts.accountnumber=<span style=\"color: #a31515;\">\"'.$accountnumber.'\"</span> AND data_debts.currentamt&gt;<span style=\"color: #a31515;\">\"0\"</span> AND data_debts.clientname = data_clients.accountnumber\n\t';\n\t$results = queryDB($select); <span style=\"color: green;\">//my queryDB function returns an object or false, depending on whether it gets a hit or not - so YMMV depending on how you return your query data</span>\n\t$table = <span style=\"color: #a31515;\">''</span>; <span style=\"color: green;\">//empty table</span>\n\t<span style=\"color: blue;\">if</span>($results){ <span style=\"color: green;\">//if there was data returned from queryDB()</span>\n\t\t$table .= <span style=\"color: #a31515;\">'&lt;w:tbl&gt;'</span>;\n\t\t$table .= <span style=\"color: #a31515;\">'&lt;w:tblPr&gt;&lt;w:tblW w:w = \"5000\" w:type=\"pct\"/&gt;&lt;/w:tblPr&gt;'</span>;\n\t\t<span style=\"color: blue;\">foreach</span>($results <span style=\"color: blue;\">as</span> $debt){\n\t\t\t$table .= <span style=\"color: #a31515;\">'&lt;w:tr&gt;'</span>; <span style=\"color: green;\">//new xml table row</span>\n\t\t\t$table .= <span style=\"color: #a31515;\">'&lt;w:tc&gt;&lt;w:p&gt;&lt;w:r&gt;&lt;w:t&gt;'</span>; <span style=\"color: green;\">//start cell</span>\n\t\t\t$table .= $debt-&gt;clientname; <span style=\"color: green;\">//cell contents</span>\n\t\t\t$table .= <span style=\"color: #a31515;\">'&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;&lt;/w:tc&gt;'</span>; <span style=\"color: green;\">//close cell</span>\n\t\t\t$table .= <span style=\"color: #a31515;\">'&lt;w:tc&gt;&lt;w:p&gt;&lt;w:r&gt;&lt;w:t&gt;'</span>;\n\t\t\t$table .= $debt-&gt;clientaccount;\n\t\t\t$table .= <span style=\"color: #a31515;\">'&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;&lt;/w:tc&gt;'</span>;\n\t\t\t$table .= <span style=\"color: #a31515;\">'&lt;w:tc&gt;&lt;w:p&gt;&lt;w:r&gt;&lt;w:t&gt;'</span>;\n\t\t\t$table .= $debt-&gt;regard;\n\t\t\t$table .= <span style=\"color: #a31515;\">'&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;&lt;/w:tc&gt;'</span>;\t\t\n\t\t\t$table .= <span style=\"color: #a31515;\">'&lt;w:tc&gt;&lt;w:p&gt;&lt;w:r&gt;&lt;w:t&gt;'</span>;\n\t\t\t$table .= int2cash($debt-&gt;currentamt);\n\t\t\t$table .= <span style=\"color: #a31515;\">'&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;&lt;/w:tc&gt;'</span>;\n\t\t\t$table .= <span style=\"color: #a31515;\">'&lt;/w:tr&gt;'</span>;\n\t\t} <span style=\"color: green;\">//done with dynamic data</span>\n\t\t$table .= <span style=\"color: #a31515;\">'&lt;/w:tbl&gt;'</span>; <span style=\"color: green;\">//close xml table</span>\n\t\t$template-&gt;setValue(<span style=\"color: #a31515;\">'ACCOUNTINFO'</span>,$table); <span style=\"color: green;\">//insert xml into template</span>\n\t\n\t}<span style=\"color: blue;\">else</span>{setAlert(<span style=\"color: #a31515;\">'error'</span>,<span style=\"color: #a31515;\">'No info for this account'</span>); <span style=\"color: blue;\">return</span> 0;} <span style=\"color: green;\">//returns 0 if proc failed</span>\n\t\t$template-&gt;save(<span style=\"color: #a31515;\">'data/'</span>.$filename.<span style=\"color: #a31515;\">''</span>); <span style=\"color: green;\">//save filled out template</span>\n\t\t<span style=\"color: blue;\">return</span> 1; <span style=\"color: green;\">//returns 1 if everything worked</span>\n\t}\n}\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>As you can see above, I have two spots in my template that I replace (there's more, but for simplification this works) -- ${ACCOUNTNUMBER} and ${ACCOUNTINFO}</p>\n<p>The accountinfo spot takes the table data, accountnumber spot just takes a single value.</p>\n<p>you can build out your tables like this in any way you want. I'm sure that with a little finesse you could build a function that dynamically converts html table data to xml data, in this case I was in a rush to get the rough draft working, and haven't had  to go back and modify it for anything yet.</p>\n<p>At any rate, this code worked 100% for me. &nbsp;Let me know if you have trouble implementing something similar.</p>\n<p>note-- if in the directory that you are using to store the actual original templates you see &nbsp;files that have filenames that look like random numbers, and they are accumulating, then there's SOMETHING WRONG, and the function is NOT closing out properly... &nbsp;I've found that when this happens, the final \"filled out\" template file seems to be malformed as well. &nbsp;Check all of your settings and permissions and just make sure you don't have any errors within your php script. &nbsp;This was a head-against-wall issue for me a couple of times, and its a real pain to track down sometimes (see my other post about malformed output).</p>",
    "PostedDate": "2012-02-15T11:36:17.07-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "768115",
    "ThreadId": "254789",
    "Html": "<p>Thanks! I am writing the code and it looks similar to yours. Let me ask the question a different way.</p>\r\n<p>Did you manually add the ${ACCOUNTINFO} to the document.xml file, or did you use one of the PHPWord addText functions to get it there?</p>\r\n<p>I realize I could just insert the placeholder manually since Word won't be used to open the template, and I don't think loadTemplate cares about it.</p>",
    "PostedDate": "2012-02-15T11:49:36.16-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "768128",
    "ThreadId": "254789",
    "Html": "<p>I use Word to set up my templates - so ${ACCOUNTINFO} went into my template.docx file.</p>\r\n<p>IF your query returns NO DATA - you could have ${ACCOUNTINFO} still be replaced, but by blank text... &nbsp;same result as not putting ${ACCOUNTINFO} into the template in the first place.</p>\r\n<p>If you're trying to dynamically add ${ACCOUNTINFO} directly to the template... &nbsp;that's a whole can of worms you may not want to get into.</p>",
    "PostedDate": "2012-02-15T11:59:13.823-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "768164",
    "ThreadId": "254789",
    "Html": "<p>OK, thanks. I'll try just adding it manually to the xml file just to see if that works. If that doesn't work, I'll add it in Word.</p>\r\n<p>I used PHPWord to build the template. When I started I thought I would be able to use one program to dynamically build the whole file, including the data.</p>\r\n<p>It would have taken less time to build the document in Word, with placeholders, and then just use the PHPWord template functions. I will probably have to modify the template in Word anyway to fix some of the formatting issues I can't get around with PHPWord - the minimum height problem in table rows, and no way to add special characters. It's a great tool though, and I';m sure it will get better.</p>\r\n<p>Note: special characters could be added the way you are adding the table. But, again, it's easier to do it in Word than dig through a compressed xml file to find the sequence.</p>\r\n<p>I'll post again when I get it working.</p>",
    "PostedDate": "2012-02-15T12:16:01.257-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "768214",
    "ThreadId": "254789",
    "Html": "<p>Well, if you're up to it, what you COULD do is...</p>\r\n<p>build the template (use phpword to create a docX) and wherever in that template you want the table to be, just put a ${TABLE} placeholder, then REPROCESS that template file like you would any other template.</p>\r\n<p>Assuming you're building the original template file as a docX using phpword, you should be able to open it in word just to confirm that it's laid out exactly where you want it.</p>\r\n<p>1. use PHPWord to build template docx - insert ${PLACEHOLDERS} wherever you will need them for the second pass</p>\r\n<p>2. save that \"temp\" template.docx somewhere in your filesystem</p>\r\n<p>3. re-open that template.docx as a template with PHPWord</p>\r\n<p>4. complete your replacements</p>\r\n<p>5. save the final docx</p>\r\n<p>6. clean up the template files using PHP file handling functions</p>",
    "PostedDate": "2012-02-15T12:40:15.127-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "921885",
    "ThreadId": "254789",
    "Html": "<p>xomby, just want to learn the interaction between MySQL and PHPWord. Here is what I am trying to do:</p>\r\n<p>﻿﻿﻿I am trying to link data from MySQL Database into a Word Document using PHPWord. I've set up the package on my server and examples are working fine. When I use the Simple example Text.php:<br /><br /><!--p require_once 'PHPWord.php';  // New Word Document $PHPWord = new PHPWord();  // New portrait section $section = $PHPWor-->createSection();<br /><br />// Add footer<br />$footer = $section-&gt;createFooter();<br />$footer-&gt;addPreserveText('Page {PAGE} of {NUMPAGES}.', array('align'=&gt;'center'));<br /><br />// Add text elements<br />$section-&gt;addText('Hello World!');<br />$section-&gt;addTextBreak(2);<br /><br />$section-&gt;addText('I am inline styled.', array('name'=&gt;'Verdana', 'color'=&gt;'006699'));<br />$section-&gt;addTextBreak(2);<br /><br />$PHPWord-&gt;addFontStyle('rStyle', array('bold'=&gt;true, 'italic'=&gt;true, 'size'=&gt;16));<br />$PHPWord-&gt;addParagraphStyle('pStyle', array('align'=&gt;'center', 'spaceAfter'=&gt;100));<br />$section-&gt;addText('I am styled by two style definitions.', 'rStyle', 'pStyle');<br />$section-&gt;addText('I have only a paragraph style definition.', null, 'pStyle');<br /><br /><br />// Save File<br />$objWriter = PHPWord_IOFactory::createWriter($PHPWord, 'Word2007');<br />$objWriter-&gt;save('Text.docx');<br />?&gt;<br /><br /><br /><br />And try to add just before that:<br /><br /><br /><br />include(\"config.inc.php3\");<br />include(\"session.inc.php3\");<br /><br />$query=\"SELECT Opt1,Current_Exm FROM System WHERE Opt1='1'\";<br />$rbsult=MYSQL_QUERY($query) or redirect(\"http://www.cspsopcs.com/portal/eng/error.php3?err=4682\");<br />if(!$rbw=MYSQL_FETCH_ARRAY($rbsult))<br />&nbsp; {<br />&nbsp; redirect(\"error.php3?err=4682\");<br />&nbsp; }<br /><br /><br /><br />The word document is not generated. I'd like to simply replace \"HELLO WORLD\" by a variable $rbw[1]<br /><br />Is there a way or something I dont understand?<br /><br /><br /><br />Thanks!<br /><br /></p>",
    "PostedDate": "2012-10-04T07:04:46.257-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "921892",
    "ThreadId": "254789",
    "Html": "<p>Charest,&nbsp;</p>\r\n<p>This should really have been in a new thread, as it has no bearing on the current one.</p>\r\n<p>Looking at your code, I'm not seeing anything that actually connects to a database before the MYSQ_QUERY.</p>\r\n<p>When you run this code, currently, &nbsp;is it redirecting you to the error page?</p>",
    "PostedDate": "2012-10-04T07:19:51.243-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "921912",
    "ThreadId": "254789",
    "Html": "<p>HI, Thanks it is on post # 397684 but I read other post afterward and realize this might be something similar.</p>\r\n<p>&nbsp;</p>\r\n<p>So yes please reply to the other post.</p>\r\n<p>&nbsp;</p>\r\n<p>To answer your question no, it simply stop without creating the docx document. As soon as the first pasrt isnt there it work. If I add the first line:</p>\r\n<p>&nbsp;</p>\r\n<p>﻿include(\"config.inc.php\");</p>\r\n<p>it wont work.</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks!</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2012-10-04T07:59:14.687-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "958519",
    "ThreadId": "254789",
    "Html": "\r\n<blockquote style=\"border:solid .1em #ccc; font-style:italic; margin:.25em 1em 0 1em; padding:0 .25em 0 .25em\">\r\n<strong>xomby wrote:</strong><br>\r\n<p>Let me just start out with, I needed this functionality YESTERDAY, however as such, its not possible using this method. &nbsp;</p>\r\n<p>What I have found WORKS, will require a bit of know-how about how tables are laid out in XML (Don't worry, I explain enough of it here, if you have a passing knowledge of HTML markup, you'll be able to follow!).</p>\r\n<p><em><strong><span style=\"color:#ff0000\">WARNING: &nbsp;I don't claim that the following code is 100% perfect word XML, but is the bare minimum of fussing that I've found still works fine in word (2010, at least).</span></strong></em></p>\r\n<p>Instead of using the built-in table setup (I realize this loses some formatting functionality, but peruse some xml sheets out of a live word document and you can figure out where to add in the formatting), I built my tables as a string of XML markup.</p>\r\n<p>Essentially:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>HTML:\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">table</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">table</span><span style=\"color:blue\">&gt;</span>\r\nis replaced by XML:\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tbl</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tbl</span><span style=\"color:blue\">&gt;</span>\r\n\r\nHTML:\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span>\r\nis replaced by XML:\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span>\r\n\r\nHTML:\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>CONTENT HERE<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\nis replaced by XML:\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tc</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>CONTENT HERE<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tc</span><span style=\"color:blue\">&gt;</span>\r\n\r\nSo if you generate your table something like this:\r\n\r\n$table = &quot;<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tbl</span><span style=\"color:blue\">&gt;</span>&quot;;\r\nforeach($competences as $cle1 =&gt; $valeur1){\r\n  foreach($valeur1 as $cle2=&gt;$valeur2){\r\n    $table .= &quot;<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span>&quot;;\r\n    $table .= &quot;<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tc</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>&quot;;\r\n    $table .= &quot;$cle1,$valeur2&quot;;\r\n    $table .= &quot;<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tc</span><span style=\"color:blue\">&gt;</span>&quot;;\r\n    $table .= &quot;<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tr</span><span style=\"color:blue\">&gt;</span>&quot;;\r\n  }\r\n}\r\n$table .= '<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tbl</span><span style=\"color:blue\">&gt;</span>';\r\n\r\n$document-&gt;setValue('Competences',$table);</pre>\r\n</div>\r\n<p>I've found this works like a charm, however AS IS offers no formatting options. &nbsp;If you want formatting options, tear apart a simple word document and look for the XML that does what you want it to do.</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>Hint:\r\nAt least for me, adding:\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tblPr</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tblW</span> <span style=\"color:red\">w:w</span> <span style=\"color:blue\">=</span> <span style=\"color:black\">&quot;</span><span style=\"color:blue\">5000</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">w:type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">pct</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tblPr</span><span style=\"color:blue\">&gt;</span>\r\nAFTER the <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">tbl</span><span style=\"color:blue\">&gt;</span>\r\ngave me a 100% wide table with cells that auto-adjust their width.\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n</blockquote>\r\n<p>Hello,</p>\r\n<p>It doesn't works for me, the final document seems to be corrupt...</p>\r\n<p>When i open it i've an error about special chars (&lt;/&gt; in table insert)</p>\r\n<p>Do you know a solution ? I've tested the setvalue function with a simple value :</p>\r\n<pre>$template-&gt;setValue(<span style=\"color:#a31515\">'mytab'</span>,'&');<br>And the docuement is corrupt too... Why ?<br><br>Thx :) (sorry for my bad english)</pre>\r\n",
    "PostedDate": "2012-12-19T08:33:37.91-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "967813",
    "ThreadId": "254789",
    "Html": "\r\n<p>Hi okiseb, hi everyone,</p>\r\n<p>Like okieb the first attempt gave me a corrupted document, there a small fault in the examples above : but I don't get any table in my document.</p>\r\n<p>&nbsp;</p>\r\n<p>Here is the code I use :</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>\t\t$PHPWord = <span style=\"color:blue\">new</span> PHPWord();\n\n\t\t$document = $PHPWord-&gt;loadTemplate(<span style=\"color:#a31515\">'myTemplate.docx'</span>);\n\t\t\n\t\t$competences = <span style=\"color:blue\">array</span>(\n\t\t        <span style=\"color:#a31515\">&quot;Developpement&quot;</span>  =&gt; <span style=\"color:blue\">array</span>(\n\t\t              <span style=\"color:#a31515\">&quot;JAVA&quot;</span>,<span style=\"color:#a31515\">&quot;PHP&quot;</span>,<span style=\"color:#a31515\">&quot;HTML&quot;</span>),\n\t\t     \n\t\t        <span style=\"color:#a31515\">&quot;Data base&quot;</span>  =&gt; <span style=\"color:blue\">array</span>(\n\t\t              <span style=\"color:#a31515\">&quot;ORACLE&quot;</span>,<span style=\"color:#a31515\">&quot;MYSQL&quot;</span>,<span style=\"color:#a31515\">&quot;DATABASE&quot;</span>),\n\t\t     \n\t\t        <span style=\"color:#a31515\">&quot;Framework&quot;</span>  =&gt; <span style=\"color:blue\">array</span>(\n\t\t              <span style=\"color:#a31515\">&quot;LIEFRY&quot;</span> ,<span style=\"color:#a31515\">&quot;STRUTS&quot;</span> ,<span style=\"color:#a31515\">&quot;NOHETO&quot;</span> \n\t\t\t\t\t  )\n\t\t);\n\t\t$table = <span style=\"color:#a31515\">&quot;&lt;w:tbl&gt;&quot;</span>;\n\t\t<span style=\"color:blue\">foreach</span>($competences <span style=\"color:blue\">as</span> $cle1 =&gt; $valeur1){\n\t\t\t<span style=\"color:blue\">foreach</span>($valeur1 <span style=\"color:blue\">as</span> $cle2=&gt;$valeur2){\n\t\t\t\t$table .= <span style=\"color:#a31515\">&quot;&lt;w:tr&gt;&quot;</span>;\n\t\t\t\t$table .= <span style=\"color:#a31515\">&quot;&lt;w:tc&gt;&lt;w:p&gt;&lt;w:r&gt;&lt;w:t&gt;&quot;</span>;\n\t\t\t\t$table .= <span style=\"color:#a31515\">&quot;$cle1,$valeur2&quot;</span>;\n\t\t\t\t$table .= <span style=\"color:#a31515\">&quot;&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;&lt;/w:tc&gt;&quot;</span>;\n\t\t\t\t$table .= <span style=\"color:#a31515\">&quot;&lt;/w:tr&gt;&quot;</span>;\n\t\t\t}\n\t\t}\n\t\t$table .= <span style=\"color:#a31515\">'&lt;/w:tbl&gt;'</span>;\n\t\t\n\t\t$document-&gt;setValue(<span style=\"color:#a31515\">'table'</span>, $table\t);\n\n</pre>\r\n</div>\r\n<p>For okiseb change the row&nbsp;</p>\r\n<pre>$table .= &quot;&lt;/w:t&gt;&lt;/w:p&gt;&lt;/w:tc&gt;&quot;;</pre>\r\n<p>By</p>\r\n<pre>$table .= &quot;&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;&lt;/w:tc&gt;&quot;;</pre>\r\n<p>Then the document will not be corrupted anymore.</p>\r\n<p>Nevertheless this code write no table in my template.</p>\r\n<p>Any help will be appreciated.</p>\r\n<p>Best regards,</p>\r\n<p>Roger</p>\r\n",
    "PostedDate": "2012-12-24T02:39:48.683-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1000935",
    "ThreadId": "254789",
    "Html": "hi xomby,\r<br />\n<br />\nYour code was very succesfully, but I want to know how Can I set styles like borderColor or bgColor to the rows of the table and the text inside.\r<br />\n<br />\nDo you know a solution ?\r<br />\n<br />\nP.D. sorry for the bad English.<br />\n",
    "PostedDate": "2013-02-13T20:33:31.08-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1014725",
    "ThreadId": "254789",
    "Html": "I had the same issue. To resolve it I wrote a small function to clone a template row.<br />\n<br />\nThe concept is as follows:<br />\n<ol>\n<li>Create a template with one or more tables each containing one row that will be used as a template row</li>\n<li>Clone this template row as many times a required</li>\n<li>\nUse the existing setValue to set the values of all tags. The original tags have been appended with #rowNumber to identify the individuality tags on each row.<br />\n</li>\n</ol>\nThis is the function you'll have to add to the Template.php file found inside the PHPWord directory.<br />\n<pre><code>public function cloneRow($search, $numberOfClones) {\n        if(substr($search, 0, 2) !== '${' &amp;&amp; substr($search, -1) !== '}') {\n            $search = '${'.$search.'}';\n        }\n                \n        $tagPos      = strpos($this-&gt;_documentXML, $search);\n        $rowStartPos = strrpos($this-&gt;_documentXML, &quot;&lt;w:tr&quot;, ((strlen($this-&gt;_documentXML) - $tagPos) * -1));\n        $rowEndPos   = strpos($this-&gt;_documentXML, &quot;&lt;/w:tr&gt;&quot;, $tagPos) + 7;\n\n        $result = substr($this-&gt;_documentXML, 0, $rowStartPos);\n        $xmlRow = substr($this-&gt;_documentXML, $rowStartPos, ($rowEndPos - $rowStartPos));\n        for ($i = 1; $i &lt;= $numberOfClones; $i++) {\n            $result .= preg_replace('/\\$\\{(.*?)\\}/','\\${\\\\1#'.$i.'}', $xmlRow);\n        }\n        $result .= substr($this-&gt;_documentXML, $rowEndPos);\n\n        $this-&gt;_documentXML = $result;\n    }</code></pre>\n\nSome more documentation and the latest version of this code can be found at <a href=\"http://jeroen.is/phpword-templates-with-repeating-rows/\" rel=\"nofollow\">http://jeroen.is/phpword-templates-with-repeating-rows/</a> <br />\n",
    "PostedDate": "2013-03-13T10:41:41.46-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1491968",
    "ThreadId": "254789",
    "Html": "a suggestion to replace a token in template by a table\r<br />\n<br />\n<strong>In /PHPWord/Shared/XMLWriter.php</strong>\r<br />\n<br />\nAdd this <br />\n<pre><code>public function setIndent($indent) {\n    $this-&gt;_xmlWriter-&gt;setIndent((bool)$indent);\n}\npublic function setIndentString($indentString) {\n    $this-&gt;_xmlWriter-&gt;setIndentString((string)$indentString);\n}\npublic function getWriter() {\n    return $this-&gt;_xmlWriter;\n}\n</code></pre>\n\n<strong>In /PHPWord/Writer/Word2007/Base.php</strong>\r<br />\n<br />\nreplace on line 372 :<br />\n<pre><code>protected function _writeTable(PHPWord_Shared_XMLWriter $objWriter = null, PHPWord_Section_Table $table)</code></pre>\n\nby <br />\n<pre><code>public function _writeTable(PHPWord_Shared_XMLWriter $objWriter = null, PHPWord_Section_Table $table)</code></pre>\n\n<strong>And a example of use :</strong><br />\n<pre><code>$PHPWord = new PHPWord();\n$document = $PHPWord-&gt;loadTemplate('Template.docx');\n\n// the construction of the table \n$section = $PHPWord-&gt;createSection();\n$table = $section-&gt;addTable();\n$competences = array(\n    &quot;Developpement&quot;  =&gt; array(&quot;JAVA&quot;,&quot;PHP&quot;,&quot;HTML&quot;, &quot;ttttt&quot;),     \n    &quot;Data base&quot;  =&gt; array(&quot;ORACLE&quot;,&quot;MYSQL&quot;,&quot;DATABASE&quot;, &quot;ttttt&quot;),     \n    &quot;Framework&quot;  =&gt; array(&quot;LIEFRY&quot; ,&quot;STRUTS&quot; ,&quot;NOHETO&quot;, &quot;ttttt&quot;),\n);\nforeach($competences as $cle1 =&gt; $valeur1)\n{\n    foreach ($valeur1 as $cle2=&gt;$valeur2)\n    {\n     $table-&gt;addRow();\n     $table-&gt;addCell(1750)-&gt;addText(&quot;$cle1,$valeur2&quot;);\n    }\n}\n\n$objWriter = new PHPWord_Shared_XMLWriter();\n$objWriter-&gt;setIndent(FALSE);\n$objWriter-&gt;setIndentString('');\n$word2007Writer = new PHPWord_Writer_Word2007_Base();\n$word2007Writer-&gt;_writeTable($objWriter, $table);\n$xmlWriter = $objWriter-&gt;getWriter();\n$output = $xmlWriter-&gt;outputMemory();\n\n$document-&gt;setValue('test', $output );\n\n$document-&gt;save('Solarsystem.docx');</code></pre>\n\n",
    "PostedDate": "2017-01-31T02:38:20.347-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]