[
  {
    "Id": "625314",
    "ThreadId": "260753",
    "Html": "\r\n<p>Hi,</p>\r\n<p>i have another prob i hope someone can help me with. I use the gd library to output an image to a doc (code below)</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">public</span> <span style=\"color:blue\">function</span> createDoc(){\r\n  \r\n   <span style=\"color:blue\">echo</span> <span style=\"color:#a31515\">'&lt;img src=&quot;http://localhost/label_creator/wp-content/plugins/labels/lebelimage.php&quot; /&gt;'</span>;\r\n    $section = $this-&gt;createSection();\r\n    $section-&gt;addText(<span style=\"color:#a31515\">'hello world'</span>);\r\n    $section-&gt;addMemoryImage(<span style=\"color:#a31515\">'http://localhost/label_creator/wp-content/plugins/labels/lebelimage.php?src='</span>.$this-&gt;image);\r\n    $objWriter = PHPWord_IOFactory::createWriter($this, <span style=\"color:#a31515\">'Word2007'</span>);\r\n    $objWriter-&gt;save(<span style=\"color:#a31515\">'helloWorld2.docx'</span>);\r\n          \r\n}\r\n</pre>\r\n<pre><br></pre>\r\n<pre>the lebelimage.php script</pre>\r\n<pre><br></pre>\r\n<pre><pre>&lt;?php\r\n$image = imagecreatefromjpeg(<span>'http://localhost/label_creator/wp-content/media/Become-a-friend_small.jpg'</span>);\r\n \r\n<span>// Tell the browser we will output a PNG image</span>\r\nheader(<span>&quot;Content-Type: image/jpg&quot;</span>);\r\n \r\n<span>// Output the image to the browser in PNG format</span>\r\nimagejpeg($image);</pre>\r\n<br></pre>\r\n<pre><br></pre>\r\n<pre>The echo script in the first code block is to output the gd image to the browser which works, so i know it's coming through ok.&nbsp;</pre>\r\n<pre>The problem i'm having is on the doc folder the image placeholder is there but there is no image just a red cross (<a href=\"http://www.dragonsdesign.co.uk\" target=\"_blank\">screen shot here</a> )</pre>\r\n<pre>if i create the image from scratch from the gd library it works but when using an image from the server i get the prob, i haven't sent the dimensions but it works these out so something is coming through, stumped.</pre>\r\n<pre>thanks</pre>\r\n<pre><br></pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-06-09T05:45:25.367-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]