[
  {
    "Id": "926377",
    "ThreadId": "399295",
    "Html": "\r\n<p>Hello I am trying to create a doc with a table in it. Both document are working fine in different docs. I combined them and it stopped to word. It is combination of Template.php and Advancedtable.php.</p>\r\n<p>Could you please have a look and advice what I should correct or where to start?</p>\r\n<p>thnaks</p>\r\n<p>mpol_ch</p>\r\n<p>&lt;?php<br>\r\n<br>\r\nmysql_connect(&quot;localhost&quot;, &quot;read566&quot;, &quot;*****&quot;) or die(mysql_error());<br>\r\necho &quot;Connected to MySQL&lt;br /&gt;&quot;;<br>\r\nmysql_select_db(&quot;testdb&quot;) or die(mysql_error());<br>\r\necho &quot;Connected to Database&quot;;<br>\r\necho getcwd() . &quot;\\n&quot;;<br>\r\nrequire_once(&quot;C:/xampp/htdocs/9/tests/free_phpword/phpword/PHPWord.php&quot;);<br>\r\n<br>\r\n// New Word Document<br>\r\n$PHPWord = new PHPWord();<br>\r\n<br>\r\n$document = $PHPWord-&gt;loadTemplate('vorlage.docx');<br>\r\n<br>\r\n$document-&gt;setValue('Value1', 'Sun');<br>\r\n$document-&gt;setValue('Value2', 'Mercury');<br>\r\n$document-&gt;setValue('Value3', 'Venus');<br>\r\n$document-&gt;setValue('Value4', 'Earth');<br>\r\n$document-&gt;setValue('Value5', 'Mars');<br>\r\n$document-&gt;setValue('Value6', 'Jupiter');<br>\r\n$document-&gt;setValue('Value7', 'Saturn');<br>\r\n$document-&gt;setValue('Value8', 'Uranus');<br>\r\n$document-&gt;setValue('Value9', 'Neptun');<br>\r\n$document-&gt;setValue('Value10', 'Pluto');<br>\r\n<br>\r\n$document-&gt;setValue('weekday', date('l'));<br>\r\n$document-&gt;setValue('time', date('H:i'));<br>\r\n<br>\r\n<br>\r\n<br>\r\n// New portrait section<br>\r\n$section = $PHPWord-&gt;createSection();<br>\r\n$section-&gt;addText('I am placed on a default section.');<br>\r\n<br>\r\n// Define table style arrays<br>\r\n$styleTable = array('borderSize'=&gt;6, 'borderColor'=&gt;'006699', 'cellMargin'=&gt;80);<br>\r\n$styleFirstRow = array('borderBottomSize'=&gt;18, 'borderBottomColor'=&gt;'0000FF', 'bgColor'=&gt;'66BBFF');<br>\r\n<br>\r\n// Define cell style arrays<br>\r\n$styleCell = array('valign'=&gt;'center');<br>\r\n$styleCellBTLR = array('valign'=&gt;'center', 'textDirection'=&gt;PHPWord_Style_Cell::TEXT_DIR_BTLR);<br>\r\n<br>\r\n// Define font style for first row<br>\r\n$fontStyle = array('bold'=&gt;true, 'align'=&gt;'center');<br>\r\n<br>\r\n// Add table style<br>\r\n$PHPWord-&gt;addTableStyle('myOwnTableStyle', $styleTable, $styleFirstRow);<br>\r\n<br>\r\n// Add table<br>\r\n$table = $section-&gt;addTable('myOwnTableStyle');<br>\r\n// Add row<br>\r\n$table-&gt;addRow(500);<br>\r\n<br>\r\n// Add cells<br>\r\n$table-&gt;addCell(100, $styleCell)-&gt;addText('Id', $fontStyle);<br>\r\n$table-&gt;addCell(5000, $styleCell)-&gt;addText('Titel', $fontStyle);<br>\r\n$table-&gt;addCell(300, $styleCell)-&gt;addText('Kunde', $fontStyle);<br>\r\n$table-&gt;addCell(5000, $styleCell)-&gt;addText('Strasse', $fontStyle);<br>\r\n$table-&gt;addCell(1000, $styleCellBTLR)-&gt;addText('Plz', $fontStyle);<br>\r\n<br>\r\n<br>\r\n$abfrage = &quot;SELECT * FROM vertraege &quot;;<br>\r\n$ergebnis = mysql_query($abfrage);<br>\r\n$menge = mysql_num_rows($ergebnis);<br>\r\necho &quot;Anzahl der Zeilen $menge &lt;br&gt;&quot;;<br>\r\nwhile($row = mysql_fetch_array($ergebnis))<br>\r\n&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; $i=1;<br>\r\n&nbsp;&nbsp; $table-&gt;addRow();<br>\r\n&nbsp;&nbsp;&nbsp; $table-&gt;addCell(100)-&gt;addText(&quot;$row[Id]&quot;);<br>\r\n&nbsp;&nbsp;&nbsp; $table-&gt;addCell(5000)-&gt;addText(&quot;$row[Titel]&quot;);<br>\r\n&nbsp;&nbsp;&nbsp; $table-&gt;addCell(2000)-&gt;addText(&quot;$row[Kunde]&quot;);<br>\r\n&nbsp;&nbsp;&nbsp; $table-&gt;addCell(2000)-&gt;addText(&quot;$row[Strasse]&quot;);<br>\r\n&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp; $text = ($i % 2 == 0) ? '$row[Ort]' : '';<br>\r\n&nbsp;&nbsp;&nbsp; $table-&gt;addCell(500)-&gt;addText($text);<br>\r\n&nbsp; $i&#43;&#43;; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp; }<br>\r\n<br>\r\n<br>\r\n<br>\r\n// Save File<br>\r\n$document = PHPWord_IOFactory::createWriter($PHPWord, 'Word2007');<br>\r\n$document-&gt;save('mydocs/erweitertetabelle.docx');<br>\r\n//$document-&gt;save('mydocs/erweitertetabelle.docx');<br>\r\n?&gt;</p>\r\n",
    "PostedDate": "2012-10-14T09:09:54.26-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]