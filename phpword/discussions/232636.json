[
  {
    "Id": "513902",
    "ThreadId": "232636",
    "Html": "\r\n<p>I'm having weird issues with the setValue function when working with word templates.</p>\r\n<p>At first, it seemed that PHPWord was randomly skipping some setValue requests, despite the fact the search string matched the equivelant string in the word document.</p>\r\n<p>After a couple of hours playing, I finally worked out that if a string was flagged as misspelled by the word spellchecker, the string would not be replaced.</p>\r\n<p>I resolved the issue by simply turning off the spellchecker, and retyping all the strings. &nbsp;It sounds bizarre, and totally unfeasable, but it did work.&nbsp;</p>\r\n<p>I can only assume that word somehow flags mispelled words in the xml when you save the file, which then interferes with PHPWord's parsing. I don't have time to go into the xml, but I presume this is the case.</p>\r\n<p>So, if anybody has any issues with setValue not finding strings, try turning off spellcheck. It might just work</p>\r\n",
    "PostedDate": "2010-10-28T04:34:19.847-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "522484",
    "ThreadId": "232636",
    "Html": "\r\n<p>i believe you are exactly correct. I was investigating some issues where only 3 of my values would be replaced. I also saw some other users in the issue tracker area that had weird issues with value replacement.&nbsp; After the above suggestion i looked\r\n at the XML and there are oddities.&nbsp; Below i've pasted in a relevant example from a document i created.&nbsp; The &quot;firstName&quot;, &quot;lastName&quot;, and &quot;streetAddress&quot; variables didn't get replaced while the &quot;city&quot;, &quot;state&quot;, and &quot;zip&quot; ones did.&nbsp; They also\r\n don't have the spellchecker XML around them marking them as not spelled correctly:</p>\r\n<p>original as seen in the word document:<br>\r\nTo: ${firstName} ${lastName}<br>\r\n${streetAddress}<br>\r\n${city}, ${state} ${zip}</p>\r\n<p>XML Version:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">p</span> <span style=\"color:red\">w:rsidR</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">00E54A02</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">w:rsidRDefault</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">00E54A02</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>To: ${<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">proofErr</span> <span style=\"color:red\">w:type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">spellStart</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>firstName<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">proofErr</span> <span style=\"color:red\">w:type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">spellEnd</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>} ${<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">proofErr</span> <span style=\"color:red\">w:type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">spellStart</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>lastName<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">proofErr</span> <span style=\"color:red\">w:type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">spellEnd</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">proofErr</span> <span style=\"color:red\">w:type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">gramStart</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>}<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">proofErr</span> <span style=\"color:red\">w:type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">gramEnd</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">br</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>${<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">proofErr</span> <span style=\"color:red\">w:type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">spellStart</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>streetAddress<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">proofErr</span> <span style=\"color:red\">w:type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">spellEnd</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>}<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">br</span><span style=\"color:blue\">/&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>${city}, ${state} ${zip}<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">t</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">r</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">w</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">p</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2010-11-15T20:48:13.66-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "671596",
    "ThreadId": "232636",
    "Html": "<p>To fix the problem without changing anything in word, I've edited few things in the Template class :&nbsp;</p>\r\n<p>adding static function \"striptags\"</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">private</span> <span style=\"color: blue;\">static</span> <span style=\"color: blue;\">function</span> striptags($matches)\r\n{\r\n\t<span style=\"color: blue;\">return</span> strip_tags($matches[1]);\r\n}\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>Then add this line at the end of the constructor</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>$this-&gt;_documentXML = preg_replace_callback(<span style=\"color: #a31515;\">'/(\\$\\{.*\\})/U'</span>,<span style=\"color: #a31515;\">\"self::striptags\"</span>, $this-&gt;_documentXML );</pre>\r\n</div>\r\n<p>&nbsp;It will remove all tags added by spellcheckers for each vars</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-09-14T02:18:04.547-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "700512",
    "ThreadId": "232636",
    "Html": "<p>Thank you airmoi for the great solution!</p>\n<p>However, while I had an issue along these lines as well, I was getting things like:</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">t</span><span style=\"color: blue;\">&gt;</span>$<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">t</span><span style=\"color: blue;\">&gt;</span>\n...\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">t</span><span style=\"color: blue;\">&gt;</span>{<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">t</span><span style=\"color: blue;\">&gt;</span>\n...\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">t</span><span style=\"color: blue;\">&gt;</span>token}<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">w</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">t</span><span style=\"color: blue;\">&gt;</span>\n</pre>\n</div>\n<p>in the XML of my template docx.</p>\n<p>by changing:</p>\n<div style=\"color: black; background-color: white;\">\n<pre>$this-&gt;_documentXML = preg_replace_callback(<span style=\"color: #a31515;\">'/(\\$\\{.*\\})/U'</span>,<span style=\"color: #a31515;\">\"self::striptags\"</span>, $this-&gt;_documentXML );\n\nto: \n\n$this-&gt;_documentXML = preg_replace_callback(<span style=\"color: #a31515;\">'/(\\$.*\\})/U'</span>,<span style=\"color: #a31515;\">\"self::striptags\"</span>, $this-&gt;_documentXML );\n</pre>\n</div>\n<p>Solved the problem for me (using airmoi's solution)!</p>\n<p><span style=\"color: #ff0000;\"><strong>WARNING!: this only works if you don't use \"$\" anywhere else in your template, if you DO, set the system up to use a different symbol as a delimiter, or replace all '$' symbols with something you can replace during runtime as well (like ${dollarsign})!</strong></span></p>",
    "PostedDate": "2011-11-18T21:15:11.91-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "713683",
    "ThreadId": "232636",
    "Html": "<p>excuse me for my bad english...</p>\r\n<p>i have exact same problem and i don't know where should i add these Functions you said!</p>\r\n<p>please help me...</p>\r\n<p>thank you</p>\r\n<p>Ehsan Saraee</p>",
    "PostedDate": "2011-12-17T13:28:24.88-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "716142",
    "ThreadId": "232636",
    "Html": "<p>The above is added/modified in the Template.php file within the \"PHPWord\" folder of the source code.</p>\r\n<ol>\r\n<li>In mine, the \"$this-&gt;_documentXML\" line was added after line 74, before the closing brackets of __Construct</li>\r\n<li>Airmoi's solution was added at line 133, just before the closing brackets of the class.</li>\r\n</ol>\r\n<p>I'm not sure if your's will be exactly the same, as I have a couple of other things going on in there as well.</p>",
    "PostedDate": "2011-12-22T07:48:58.55-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1009368",
    "ThreadId": "232636",
    "Html": "xomby and airmoi, you're the man!!! Many thanks<br />\n",
    "PostedDate": "2013-03-02T17:56:42.573-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]