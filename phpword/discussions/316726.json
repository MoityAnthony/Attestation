[
  {
    "Id": "767930",
    "ThreadId": "316726",
    "Html": "\r\n<p>If I insert a header and generate a docx, the header takes space in the top of the document. The header has a certain height. To much. How can I make it less height?</p>\r\n",
    "PostedDate": "2012-02-15T10:05:19.443-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "769880",
    "ThreadId": "316726",
    "Html": "<p>I discover header &amp; footer height values were 'hard coded' (at 720 twips or ~ .5\") into Writer &gt; Word2007 &gt; Document.php</p>\n<p>I have some code that allows you to set header &amp; footer values instead. Let me know if this works.</p>\n<p>I will link this possible solution to a ticket: <a title=\"Ticket Item\" href=\"http://phpword.codeplex.com/workitem/35\" target=\"_blank\">http://phpword.codeplex.com/workitem/35</a></p>\n<p>In Section &gt; Settings.php, add variables for header &amp; footer values above __construct function</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: green;\">// add header and foot height variables</span>\n\t<span style=\"color: blue;\">private</span> $_headerHeight;\n\t<span style=\"color: blue;\">private</span> $_footerHeight;\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>And in Section &gt; Settings.php, modify __construct function with default header &amp; footer values</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">public</span> <span style=\"color: blue;\">function</span> __construct() {\n\t\t$this-&gt;_orientation = null;\n\t\t$this-&gt;_marginTop = 1418;\n\t\t$this-&gt;_marginLeft = 1418;\n\t\t$this-&gt;_marginRight\t= 1418;\n\t\t$this-&gt;_marginBottom = 1134;\n\t\t$this-&gt;_pageSizeW = $this-&gt;_defaultPageSizeW;\n\t\t$this-&gt;_pageSizeH = $this-&gt;_defaultPageSizeH;\n\t\t$this-&gt;_borderTopSize = null;\n\t\t$this-&gt;_borderTopColor = null;\n\t\t$this-&gt;_borderLeftSize = null;\n\t\t$this-&gt;_borderLeftColor = null;\n\t\t$this-&gt;_borderRightSize = null;\n\t\t$this-&gt;_borderRightColor = null;\n\t\t$this-&gt;_borderBottomSize = null;\n\t\t$this-&gt;_borderBottomColor = null;\n\t\t$this-&gt;_headerHeight = 720; <span style=\"color: green;\">// set default header and footer to 720 twips (.5 inches)</span>\n\t\t$this-&gt;_footerHeight = 720;\n\t}\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>And in Section &gt; Settings.php, add getter &amp; setter functions for header &amp; footer below __construct function</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre>\t<span style=\"color: green;\">/**\n\t * Get Header Height\n\t *\n\t * @return int\n\t */</span>\n\t<span style=\"color: blue;\">public</span> <span style=\"color: blue;\">function</span> getHeaderHeight() {\n\t\t<span style=\"color: blue;\">return</span> $this-&gt;_headerHeight;\n\t}\n\n\t<span style=\"color: green;\">/**\n\t * Set Header Height\n\t *\n\t * @param int $pValue\n\t */</span>\n\t<span style=\"color: blue;\">public</span> <span style=\"color: blue;\">function</span> setHeaderHeight($pValue = <span style=\"color: #a31515;\">''</span>) {\n\t\t$this-&gt;_headerHeight = $pValue;\n\t\t<span style=\"color: blue;\">return</span> $this;\n\t}\n\n\t<span style=\"color: green;\">/**\n\t * Get Footer Height\n\t *\n\t * @return int\n\t */</span>\n\t<span style=\"color: blue;\">public</span> <span style=\"color: blue;\">function</span> getFooterHeight() {\n\t\t<span style=\"color: blue;\">return</span> $this-&gt;_footerHeight;\n\t}\n\n\t<span style=\"color: green;\">/**\n\t * Set Footer Height\n\t *\n\t * @param int $pValue\n\t */</span>\n\t<span style=\"color: blue;\">public</span> <span style=\"color: blue;\">function</span> setFooterHeight($pValue = <span style=\"color: #a31515;\">''</span>) {\n\t\t$this-&gt;_footerHeight = $pValue;\n\t\t<span style=\"color: blue;\">return</span> $this;\n\t}\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>In Writer &gt; Word2007 &gt; Document.php</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">private</span> <span style=\"color: blue;\">function</span> _writeEndSection(PHPWord_Shared_XMLWriter $objWriter = null, PHPWord_Section $section) {\n\t\t$_settings = $section-&gt;getSettings();\n\t\t$_header = $section-&gt;getHeader();\n\t\t$_footer = $section-&gt;getFooter();\n\t\t$pgSzW = $_settings-&gt;getPageSizeW();\n\t\t$pgSzH = $_settings-&gt;getPageSizeH();\n\t\t$orientation = $_settings-&gt;getOrientation();\n\n\t\t$marginTop = $_settings-&gt;getMarginTop();\n\t\t$marginLeft = $_settings-&gt;getMarginLeft();\n\t\t$marginRight = $_settings-&gt;getMarginRight();\n\t\t$marginBottom = $_settings-&gt;getMarginBottom();\n\n<span style=\"color: green;\">// add ability to configure header and footer height</span>\n\t\t$headerHeight = $_settings-&gt;getHeaderHeight();\n\t\t$footerHeight = $_settings-&gt;getFooterHeight();\n\n\t\t$borders = $_settings-&gt;getBorderSize();\n\n\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:sectPr'</span>);\n\n\t\t\t<span style=\"color: blue;\">if</span>(!is_null($_header)) {\n\t\t\t\t$rId = $_header-&gt;getRelationId();\n\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:headerReference'</span>);\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:type'</span>, <span style=\"color: #a31515;\">'default'</span>);\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'r:id'</span>, <span style=\"color: #a31515;\">'rId'</span>.$rId);\n\t\t\t\t$objWriter-&gt;endElement();\n\t\t\t}\n\n\t\t\t<span style=\"color: blue;\">if</span>(!is_null($_footer)) {\n\t\t\t\t$rId = $_footer-&gt;getRelationId();\n\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:footerReference'</span>);\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:type'</span>, <span style=\"color: #a31515;\">'default'</span>);\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'r:id'</span>, <span style=\"color: #a31515;\">'rId'</span>.$rId);\n\t\t\t\t$objWriter-&gt;endElement();\n\t\t\t}\n\n\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:pgSz'</span>);\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:w'</span>, $pgSzW);\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:h'</span>, $pgSzH);\n\n\t\t\t\t<span style=\"color: blue;\">if</span>(!is_null($orientation) &amp;&amp; strtolower($orientation) != <span style=\"color: #a31515;\">'portrait'</span>) {\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:orient'</span>, $orientation);\n\t\t\t\t}\n\n\t\t\t$objWriter-&gt;endElement();\n\n\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:pgMar'</span>);\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:top'</span>, $marginTop);\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:right'</span>, $marginRight);\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:bottom'</span>, $marginBottom);\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:left'</span>, $marginLeft);\n<span style=\"color: green;\">// add ability to configure height of header and footer</span>\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:header'</span>, $headerHeight);\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:footer'</span>, $footerHeight);\n\t\t\t\t<span style=\"color: green;\">//$objWriter-&gt;writeAttribute('w:header', '720'); //units of measurement: twips. 720 twips = .5 inches</span>\n\t\t\t\t<span style=\"color: green;\">//$objWriter-&gt;writeAttribute('w:footer', '720');</span>\n\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:gutter'</span>, <span style=\"color: #a31515;\">'0'</span>);\n\t\t\t$objWriter-&gt;endElement();\n\n\n\t\t\t<span style=\"color: blue;\">if</span>(!is_null($borders[0]) || !is_null($borders[1]) || !is_null($borders[2]) || !is_null($borders[3])) {\n\t\t\t\t$borderColor = $_settings-&gt;getBorderColor();\n\n\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:pgBorders'</span>);\n\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:offsetFrom'</span>, <span style=\"color: #a31515;\">'page'</span>);\n\n\t\t\t\t\t<span style=\"color: blue;\">if</span>(!is_null($borders[0])) {\n\t\t\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:top'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:val'</span>, <span style=\"color: #a31515;\">'single'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:sz'</span>, $borders[0]);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:space'</span>, <span style=\"color: #a31515;\">'24'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:color'</span>, $borderColor[0]);\n\t\t\t\t\t\t$objWriter-&gt;endElement();\n\t\t\t\t\t}\n\n\t\t\t\t\t<span style=\"color: blue;\">if</span>(!is_null($borders[1])) {\n\t\t\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:left'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:val'</span>, <span style=\"color: #a31515;\">'single'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:sz'</span>, $borders[1]);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:space'</span>, <span style=\"color: #a31515;\">'24'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:color'</span>, $borderColor[1]);\n\t\t\t\t\t\t$objWriter-&gt;endElement();\n\t\t\t\t\t}\n\n\t\t\t\t\t<span style=\"color: blue;\">if</span>(!is_null($borders[2])) {\n\t\t\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:right'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:val'</span>, <span style=\"color: #a31515;\">'single'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:sz'</span>, $borders[2]);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:space'</span>, <span style=\"color: #a31515;\">'24'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:color'</span>, $borderColor[2]);\n\t\t\t\t\t\t$objWriter-&gt;endElement();\n\t\t\t\t\t}\n\n\t\t\t\t\t<span style=\"color: blue;\">if</span>(!is_null($borders[3])) {\n\t\t\t\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:bottom'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:val'</span>, <span style=\"color: #a31515;\">'single'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:sz'</span>, $borders[3]);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:space'</span>, <span style=\"color: #a31515;\">'24'</span>);\n\t\t\t\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:color'</span>, $borderColor[3]);\n\t\t\t\t\t\t$objWriter-&gt;endElement();\n\t\t\t\t\t}\n\t\t\t\t$objWriter-&gt;endElement();\n\t\t\t}\n\n\n\t\t\t$objWriter-&gt;startElement(<span style=\"color: #a31515;\">'w:cols'</span>);\n\t\t\t\t$objWriter-&gt;writeAttribute(<span style=\"color: #a31515;\">'w:space'</span>, <span style=\"color: #a31515;\">'720'</span>);\n\t\t\t$objWriter-&gt;endElement();\n\n\n\t\t$objWriter-&gt;endElement();\n\t}\n</pre>\n</div>\n<div>\n<p>&nbsp;</p>\nAnd last, use new header &amp; footer feature like this. This makes a very small 'badge' for printing.\n<p>&nbsp;</p>\n<pre><div style=\"color: black; background-color: white;\"><pre>$section = $PHPWord-&gt;createSection(<span style=\"color: blue;\">array</span>(<span style=\"color: #a31515;\">'orientation'</span>=&gt;null, <span style=\"color: #a31515;\">'marginLeft'</span>=&gt;210, <span style=\"color: #a31515;\">'marginRight'</span>=&gt;200, <span style=\"color: #a31515;\">'marginTop'</span>=&gt;620, <span style=\"color: #a31515;\">'marginBottom'</span>=&gt;0,\n                                      <span style=\"color: #a31515;\">'headerHeight'</span>=&gt;0, <span style=\"color: #a31515;\">'footerHeight'</span>=&gt;0, <span style=\"color: #a31515;\">'pageSizeW'</span>=&gt;3038.4, <span style=\"color: #a31515;\">'pageSizeH'</span>=&gt;4847.04));\n</pre>\n</div>\n</pre>\n</div>",
    "PostedDate": "2012-02-16T08:55:09.357-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "770437",
    "ThreadId": "316726",
    "Html": "<p>Thanks a lot!</p>\r\n<p>I'm not used to make/change classes, so I did change the hard coded value 720 to 0 for test purpose. And did work, almost: the header had less height, but it could be more: Word puts a return in the header, I don't know why. Do you also know how to change that?</p>\r\n<p>How is the procedure to put the code in a next patch/release PHPWord? I'm afraid my client will download in the future a new version of PHPWord and if I make changes in the code of PHPWord, the application won't work after installing the new version of PHPWord...</p>",
    "PostedDate": "2012-02-16T11:16:02.087-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "770479",
    "ThreadId": "316726",
    "Html": "<p>I don't know about 'return' in header? I did not have that problem. My modified header had no height as specified.</p>\r\n<p>How to get changes into PHPWord? raw_venture_ad is the coordinator for the project.</p>\r\n<p>I know that sometimes ideas/patches posted in the discussion board make it into releases, and I hope that is what will happen here.There have been several reasonable patches posted that have NOT yet been added, so I think maybe the project is not very active right now. I wish I had more time to help patch it, as I think it is a good project.</p>\r\n<p>As for 'client' upgrading PHPWord without your patches, you need to get stick out and smack client hand. Or at least explain danger of doing it without talking to you first.</p>\r\n<p>It is not difficult to modify PHPWord files. Open with text editor and look at code. You will see where to put the changes above. What is the worst that can happen? Good luck!</p>",
    "PostedDate": "2012-02-16T11:27:05.337-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "777518",
    "ThreadId": "316726",
    "Html": "<p>I have include your code in the php's, for the first time I worked with classes. And succesfull, it generate's a good docx!</p>\r\n<p>(I work with NetBeans. I do programma since 1986, most Basic, since 2004 with php, but I always&nbsp;make function, never classes.)</p>\r\n<p>The 'return in the header' is a effect after adding a watermark in the header. I did search several classes why he do that, could not found it. But it's not a big problem, so I do not search any further.</p>\r\n<p>I have a other problem, a big one. My client has told my it's a must have: add colums in a page. I will start a new discussion for the problem, today of tomorrow. I'm bussy with searching, maybe I'm a fast learning person and can I add some code to the&nbsp;classes of PHPWord myself :-)</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2012-02-18T07:14:04.1-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "777715",
    "ThreadId": "316726",
    "Html": "<p>Hello Jillelain,</p>\r\n<p>I did manage it (the cols), see new discussion.</p>",
    "PostedDate": "2012-02-18T09:52:33.89-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "892068",
    "ThreadId": "316726",
    "Html": "<p>works like a charm!</p>\r\n<p>thank you!</p>",
    "PostedDate": "2012-07-26T22:31:21.703-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]